// prisma/schema.prisma
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Experience {
  id          String   @id @default(uuid())
  title       String
  description String
  image_url   String
  scenes      Scene[]
}

model Scene {
  id           String      @id @default(uuid())
  title        String
  description  String
  image_url    String
  video_url    String
  // Many-to-many relationship to Artefact
  artefacts    Artefact[]  @relation("SceneToArtefact")
  // One-to-many relationship back to Experience
  experience   Experience? @relation(fields: [experienceId], references: [id])
  experienceId String?
}

model Artefact {
  id          String    @id
  title       String
  text        String
  region      String
  approx_date String
  citation    String
  scenes      Scene[]   @relation("SceneToArtefact")
  embedding   Embedding?
}

model Embedding {
  id         String   @id
  text       String
  vector     Float[]
  artefact   Artefact @relation(fields: [artefactId], references: [id])
  artefactId String   @unique
}